<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Next-Gen Surgery: RCST 2026</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --glass-bg: rgba(255,255,255,.70); --glass-brd: rgba(255,255,255,.45); --header-h: 80px; }
    body{ font-family:'Inter',sans-serif;
      background:
        radial-gradient(1200px 600px at -10% -10%, rgba(168,85,247,.10), transparent 55%),
        radial-gradient(900px 450px at 110% 0%, rgba(124,58,237,.08), transparent 55%),
        linear-gradient(180deg,#faf7ff 0%,#f5f0ff 45%,#efe9ff 100%);
      color:#0f172a;
    }
    .text-gradient{ background:linear-gradient(90deg,#7c3aed,#2563eb); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .card{ background:var(--glass-bg); border:1px solid var(--glass-brd); backdrop-filter: blur(14px); -webkit-backdrop-filter: blur(14px); }

    /* Flip SPA */
    #stage{ position:relative; perspective:1200px; margin-top:var(--header-h); min-height:calc(100vh - var(--header-h)); transition:height .35s ease; }
    .view{ position:absolute; inset:0; padding:16px 0; opacity:0; pointer-events:none; transform:rotateY(90deg) scale(.98); backface-visibility:hidden; transition:transform .7s cubic-bezier(.2,.65,.2,1), opacity .35s; }
    .view.active{ opacity:1; pointer-events:auto; transform:rotateY(0) scale(1); }
    .view.flip-out{ opacity:0; transform:rotateY(-90deg) scale(.98); }
    .view.flip-in{ opacity:1; transform:rotateY(0) scale(1); }

    /* Countdown */
    .cd-tile{ min-width:76px; padding:12px 10px; border-radius:16px; text-align:center; background:var(--glass-bg); border:1px solid var(--glass-brd); backdrop-filter: blur(10px); box-shadow:0 8px 24px rgba(15,23,42,.06); }
    .cd-value{ font-size:1.5rem; font-weight:800; line-height:1; } .cd-label{ font-size:.75rem; color:#475569; margin-top:.25rem; letter-spacing:.02em; }
    #mobile-menu{ top:var(--header-h); }

    /* Gallery */
    .flip-gallery{ position:relative; width:100%; height:56vh; }
    @media(min-width:768px){ .flip-gallery{ height:68vh; } }
    .flip-slide{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transform:rotateY(90deg) scale(.98); transition:transform .75s cubic-bezier(.2,.7,.2,1), opacity .35s; }
    .flip-slide.active{ opacity:1; transform:rotateY(0) scale(1); }
    .flip-slide.out{ opacity:0; transform:rotateY(-90deg) scale(.98); }

    /* Timeline */
    .chip{ display:inline-flex; align-items:center; gap:.5rem; padding:.5rem .75rem; border-radius:9999px; font-size:.875rem; border:1px solid rgba(255,255,255,.5); background:rgba(255,255,255,.6); backdrop-filter: blur(8px); transition:background .2s,color .2s,border-color .2s; cursor:pointer; }
    .chip[data-active="true"]{ background:#4f46e5; color:#fff; border-color:#4f46e5; }
    .tl-viewport{ position:relative; overflow-x:auto; overflow-y:visible; }
    .tl-canvas{ position:relative; height:auto; min-height:260px; margin-top:.5rem; }
    .tl-grid{ position:absolute; left:0; right:0; top:0; height:0; }
    .tl-hour,.tl-half{ position:absolute; top:0; bottom:0; width:1px; } .tl-hour{ background:rgba(15,23,42,.08);} .tl-half{ background:rgba(15,23,42,.05);}
    .tl-hour-label{ position:absolute; top:-1.75rem; transform:translateX(-50%); font-size:.75rem; color:#64748b; white-space:nowrap; background:rgba(255,255,255,.7); padding:.1rem .35rem; border-radius:.5rem; border:1px solid rgba(255,255,255,.6); }
    .session{ position:absolute; min-width:160px; border-radius:16px; padding:12px 14px; border:1px solid var(--glass-brd); background:var(--glass-bg); box-shadow:0 10px 24px rgba(2,6,23,.06); transition:transform .2s, box-shadow .2s; }
    .session:hover{ transform:translateY(-2px); box-shadow:0 14px 30px rgba(2,6,23,.10); }
    .badge{ display:inline-block; font-size:.675rem; padding:.2rem .5rem; border-radius:9999px; border:1px solid currentColor; opacity:.85; }

    .cat-general{ --cat:#334155; } .cat-uppergi{ --cat:#dc2626; } .cat-colorectal{ --cat:#16a34a; } .cat-criticalcare{ --cat:#0891b2; }
    .cat-breast_endocrine{ --cat:#9333ea; } .cat-vascular{ --cat:#2563eb; } .cat-trauma{ --cat:#ea580c; } .cat-hbp{ --cat:#065f46; } .cat-workshop{ --cat:#0ea5e9; }
    .session h3{ color:var(--cat); } .session .badge{ color:var(--cat); background:color-mix(in oklab, var(--cat) 12%, white); border-color:color-mix(in oklab, var(--cat) 55%, white); }
    .session{ border-color:color-mix(in oklab, var(--cat) 45%, white); }
    .session[data-cat="general"]{ cursor:zoom-in; }
    .session[data-cat="general"][data-expanded="true"]{ transform:scale(1.07); z-index:30; box-shadow:0 24px 50px rgba(2,6,23,.18); border-width:2px; }
  </style>
</head>
<body>

  <!-- Header -->
  <header id="site-header" class="bg-white/60 backdrop-blur-xl fixed top-0 left-0 right-0 z-50 border-b border-white/30">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
      <a href="#home" data-route="home" class="flex items-center gap-3">
        <div class="text-xl font-bold text-gradient">RCST 2026</div>
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/e962eddce38d5880ae976db69232a4f8f7b8acb9/RCST.png?raw=1" alt="RCST" class="h-8 w-auto">
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/e962eddce38d5880ae976db69232a4f8f7b8acb9/surgery.png?raw=1" alt="Surgery CMU" class="h-8 w-auto">
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/logo.jpg?raw=1" alt="MedCMU" class="h-8 w-auto">
      </a>

      <div class="hidden md:flex space-x-8 text-sm font-medium">
        <a href="#about"    data-route="about"    class="text-slate-700 hover:text-indigo-600">เกี่ยวกับ</a>
        <a href="#dates"    data-route="dates"    class="text-slate-700 hover:text-indigo-600">กำหนดการ</a>
        <a href="#speakers" data-route="speakers" class="text-slate-700 hover:text-indigo-600">หัวข้อ</a>
        <a href="#research" data-route="research" class="text-slate-700 hover:text-indigo-600">วิจัย</a>
        <a href="#venue"    data-route="venue"    class="text-slate-700 hover:text-indigo-600">สถานที่</a>
        <a href="#hotels"   data-route="hotels"   class="text-slate-700 hover:text-indigo-600">โรงแรม</a>
        <a href="#contact"  data-route="contact"  class="text-slate-700 hover:text-indigo-600">ติดต่อ</a>
      </div>

      <button id="menu-btn" class="md:hidden p-2 rounded-lg bg-white/70 hover:bg-white" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </nav>

    <!-- Mobile -->
    <div id="mobile-menu" class="md:hidden hidden fixed inset-x-0 z-40 px-4">
      <div class="mx-auto max-w-2xl rounded-2xl bg-white/95 backdrop-blur-xl shadow-xl ring-1 ring-black/5 py-3">
        <a href="#about"    data-route="about"    class="block px-4 py-3 hover:bg-slate-100 rounded-lg">เกี่ยวกับ</a>
        <a href="#dates"    data-route="dates"    class="block px-4 py-3 hover:bg-slate-100 rounded-lg">กำหนดการ</a>
        <a href="#speakers" data-route="speakers" class="block px-4 py-3 hover:bg-slate-100 rounded-lg">หัวข้อ</a>
        <a href="#research" data-route="research" class="block px-4 py-3 hover:bg-slate-100 rounded-lg">วิจัย</a>
        <a href="#venue"    data-route="venue"    class="block px-4 py-3 hover:bg-slate-100 rounded-lg">สถานที่</a>
        <a href="#hotels"   data-route="hotels"   class="block px-4 py-3 hover:bg-slate-100 rounded-lg">โรงแรม</a>
        <a href="#contact"  data-route="contact"  class="block px-4 py-3 hover:bg-slate-100 rounded-lg">ติดต่อ</a>
      </div>
    </div>
  </header>

  <!-- ===== Stage ===== -->
  <main id="stage" class="container mx-auto px-4">

    <!-- HOME -->
    <section class="view active" data-route="home" aria-label="หน้าแรก">
      <div class="min-h-[calc(100vh-140px)] flex flex-col justify-center items-center text-center">
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-gradient">งานประชุมราชวิทยาลัยศัลยแพทย์แห่งประเทศไทยส่วนภูมิภาค 2569</h1>
        <p class="text-2xl md:text-3xl font-bold text-slate-800 mt-4 md:mt-6"><span class="text-indigo-700">Next-Gen Surgery:</span><br/>Revolutionizing Surgical Practice</p>
        <a
  href="https://forms.fillout.com/t/izJe9c3BL5us"
  target="_blank" rel="noopener"
  class="mt-6 md:mt-8 inline-flex items-center justify-center rounded-full bg-indigo-600 px-10 py-4 text-lg md:text-xl font-extrabold text-white shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition"
>
  ลงทะเบียน
</a>

        <div class="mt-6 flex items-center justify-center">
          <div class="flex gap-3" aria-live="polite">
            <div class="cd-tile"><div id="cd-days" class="cd-value">00</div><div class="cd-label">วัน</div></div>
            <div class="cd-tile"><div id="cd-hours" class="cd-value">00</div><div class="cd-label">ชั่วโมง</div></div>
            <div class="cd-tile"><div id="cd-mins" class="cd-value">00</div><div class="cd-label">นาที</div></div>
            <div class="cd-tile"><div id="cd-secs" class="cd-value">00</div><div class="cd-label">วินาที</div></div>
          </div>
        </div>
        <p id="cd-note" class="mt-2 text-sm text-slate-500"></p>
      </div>

      <!-- Gallery -->
      <section class="py-8 md:py-12">
        <div class="max-w-4xl mx-auto">
          <div class="card rounded-3xl shadow-md overflow-hidden">
            <div class="flip-gallery">
              <img class="flip-slide active" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu1.JPG?raw=1"  alt="MedCMU 1"  loading="eager">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu2.JPG?raw=1"  alt="MedCMU 2"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu3.JPG?raw=1"  alt="MedCMU 3"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu4.jpg?raw=1"  alt="MedCMU 4"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu5.png?raw=1"  alt="MedCMU 5"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu6.JPG?raw=1"  alt="MedCMU 6"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu7.jpg?raw=1"  alt="MedCMU 7"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/32504c466ce38cd4895e8c72a44e97ca6b7719af/medcmu8.JPG?raw=1"   alt="MedCMU 8"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/32504c466ce38cd4895e8c72a44e97ca6b7719af/medcmu9.JPG?raw=1"   alt="MedCMU 9"  loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/32504c466ce38cd4895e8c72a44e97ca6b7719af/medcmu10.JPG?raw=1"  alt="MedCMU 10" loading="lazy">
              <img class="flip-slide"        src="https://github.com/chagkrit/rcst-2026-site/blob/32504c466ce38cd4895e8c72a44e97ca6b7719af/medcmu11.JPG?raw=1"  alt="MedCMU 11" loading="lazy">
            </div>
          </div>
        </div>
      </section>
    </section>

 <!-- ========== ABOUT ========== -->
    <section class="view" data-route="about" aria-label="เกี่ยวกับงานประชุม">
      <div class="py-10">
        <div class="max-w-4xl mx-auto text-center">
          <div class="card rounded-3xl shadow-md p-8 md:p-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient">เกี่ยวกับงานประชุม</h2>
            <p class="text-lg text-slate-700 leading-relaxed">Regional RCST 2026 in Chiang Mai คือเวทีวิชาการที่เชื่อมผู้เชี่ยวชาญศัลยกรรมจากทั่วภูมิภาคและนานาชาติ เพื่อแลกเปลี่ยนองค์ความรู้และนวัตกรรมล่าสุด ตั้งแต่ AI-assisted surgery, Robotics, Minimally Invasive/Endoscopic ไปจนถึงแนวทางรักษาที่ขับเคลื่อนด้วยข้อมูลจริง</p>
            <p class="text-lg text-slate-700 leading-relaxed mt-4">มาร่วมเตรียมทีมและสถาบันของคุณให้พร้อมต่อยุคใหม่ของการผ่าตัด—ที่ความแม่นยำ ประสิทธิภาพ และความปลอดภัยยกระดับไปอีกขั้น</p>
          </div>
        </div>
      </div>
    </section>

    <!-- DATES: ใส่ main topic ต่อท้ายแต่ละ session -->
    <section class="view" data-route="dates" aria-label="กำหนดการ">
      <div class="py-10">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-gradient">กำหนดการและหัวข้อการประชุม</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- 12 Feb -->
            <div class="card rounded-3xl p-6 shadow-md">
              <h3 class="text-base font-semibold text-slate-500">วันที่</h3>
              <h4 class="text-xl font-bold text-indigo-700 mb-4">12 กุมภาพันธ์ 2569</h4>
              <ul class="space-y-3 text-slate-700">
                <li><span class="font-medium">08:00–08:45 ลงทะเบียน</span></li>
                <li><span class="font-medium">08:45–09:00 พิธีเปิด</span></li>
                <li><span class="font-medium">09:00–09:30 ปาฐกถา ศ.นพ.โอกาส พลางกูร</span></li>
                <li><span class="font-medium">09:30–09:40 มอบรางวัลศิษย์เก่าศัลยแพทย์เชียงใหม่ดีเด่น</span></li>
                <li><span class="font-medium">09:40–10:00 ปาฐกถาศิษย์เก่าดีเด่น</span></li>
                <li><span class="font-medium">10:00–10:30 Coffee Break</span></li>
                <li><span class="font-semibold">10:30–12:00 Upper GI Surgery Session • Precision Surgery and Advanced MIS for Upper GI Surgery</span></li>
                <li><span class="font-medium">12:00–13:00 Lunch Symposium</span></li>
                <li><span class="font-semibold">13:00–14:30 Colorectal Surgery Session • Revolution of Rectal Cancer Treatment: Reframe, Refine and Resection</span></li>
                <li><span class="font-medium">14:30–15:00 Coffee Break</span></li>
                <li><span class="font-semibold">15:00–17:00 Surgical Critical Care Session • ABCD for Critical Care Monitoring</span></li>
              </ul>
            </div>
            <!-- 13 Feb -->
            <div class="card rounded-3xl p-6 shadow-md">
              <h3 class="text-base font-semibold text-slate-500">วันที่</h3>
              <h4 class="text-xl font-bold text-indigo-700 mb-4">13 กุมภาพันธ์ 2569</h4>
              <ul class="space-y-3 text-slate-700">
                <li><span class="font-semibold">08:30–10:00 Breast & Endocrine Surgery Session • Precision Beyond Breast and Endocrine Surgery</span></li>
                <li><span class="font-medium">10:00–10:30 Coffee Break</span></li>
                <li><span class="font-semibold">10:30–12:00 Vascular Surgery Session • Challenges & Solution in Chronic Leg Ulcers</span></li>
                <li><span class="font-medium">12:00–13:00 Lunch Symposium</span></li>
                <li><span class="font-semibold">13:00–14:30 Trauma Surgery Session • Trauma in the Next Generation</span></li>
                <li><span class="font-medium">14:30–15:00 Coffee Break</span></li>
                <li><span class="font-semibold">15:00–16:30 HBP Surgery Session • Mastery Technique of HBP Surgery in Emergency Setting</span></li>
              </ul>
            </div>
            <!-- 14 Feb -->
            <div class="card rounded-3xl p-6 shadow-md">
              <h3 class="text-base font-semibold text-slate-500">วันที่</h3>
              <h4 class="text-xl font-bold text-indigo-700 mb-4">14 กุมภาพันธ์ 2569</h4>
              <ul class="space-y-3 text-slate-700">
                <li><span class="font-semibold">08:00–16:00 Minimal Invasive Hernia Workshop • CMU Cadaveric Center อาคาร 50 ปี คณะแพทยศาสตร์ มช.</span></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SPEAKERS/TOPICS Timeline: ไม่มี Coffee/Lunch -->
    <section class="view" data-route="speakers" aria-label="หัวข้อ" id="view-speakers">
      <div class="py-10">
        <div class="max-w-7xl mx-auto">
          <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient text-center">หัวข้อ</h2>

          <div class="flex items-center justify-center gap-3 mb-4">
            <button class="chip" data-day-btn data-day="2026-02-12" data-active="true">12 ก.พ. 2569</button>
            <button class="chip" data-day-btn data-day="2026-02-13">13 ก.พ. 2569</button>
            <button class="chip" data-day-btn data-day="2026-02-14">14 ก.พ. 2569</button>
          </div>

          <div class="flex items-center justify-center flex-wrap gap-2 mb-2">
            <button class="chip" data-filter="all" data-active="true">ทั้งหมด</button>
            <button class="chip" data-filter="general">General / Plenary</button>
            <button class="chip" data-filter="uppergi">Upper GI</button>
            <button class="chip" data-filter="colorectal">Colorectal</button>
            <button class="chip" data-filter="criticalcare">Critical Care</button>
            <button class="chip" data-filter="breast_endocrine">Breast &amp; Endocrine</button>
            <button class="chip" data-filter="vascular">Vascular</button>
            <button class="chip" data-filter="trauma">Trauma</button>
            <button class="chip" data-filter="hbp">HBP</button>
            <button class="chip" data-filter="workshop">Workshop</button>
          </div>
          <p class="text-center text-xs text-slate-500 mb-4">ไม่มี Coffee Break และ Lunch Symposium ในมุมมอง “หัวข้อ”</p>

          <div class="flex items-center justify-center gap-2 mb-2">
            <button class="chip" id="zoom-out">−</button>
            <button class="chip" id="zoom-1x">รีเซ็ต 1.0×</button>
            <button class="chip" id="zoom-in">＋</button>
            <span id="zoom-label" class="text-xs text-slate-500 ml-2">สเกล 1.0× • 2 px/นาที</span>
          </div>

          <div class="tl-viewport card rounded-2xl p-4">
            <div class="tl-canvas" id="tl-canvas" style="min-width:1200px">
              <div class="tl-grid" id="tl-grid"></div>
            </div>
            <div class="flex items-center justify-between mt-3">
              <span class="text-xs text-slate-500">เลื่อนซ้าย-ขวาเพื่อดูช่วงเวลา</span>
              <div class="flex gap-2">
                <button class="chip" id="tl-left">◀</button>
                <button class="chip" id="tl-now">ไป 07:30</button>
                <button class="chip" id="tl-right">▶</button>
              </div>
            </div>
          </div>

          <div class="mt-4 flex flex-wrap gap-3 justify-center text-sm">
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#334155"></span>General</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#dc2626"></span>Upper GI</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#16a34a"></span>Colorectal</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#0891b2"></span>Critical Care</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#9333ea"></span>Breast &amp; Endocrine</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#2563eb"></span>Vascular</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#ea580c"></span>Trauma</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#065f46"></span>HBP</span>
            <span class="inline-flex items-center gap-2"><span class="w-3 h-3 rounded-full" style="background:#0ea5e9"></span>Workshop</span>
          </div>
        </div>
      </div>
    </section>

    <!-- RESEARCH -->
    <section class="view" data-route="research" aria-label="วิจัย">
      <div class="py-10">
        <div class="max-w-4xl mx-auto">
          <div class="card rounded-3xl shadow-md p-8 md:p-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient text-center">วิจัย • ส่งผลงาน Abstract</h2>
            <div class="space-y-4 text-slate-700 text-lg">
              <p><b>กำหนดส่ง:</b> 1 ตุลาคม 2568 ถึง 30 ธันวาคม 2568</p>
              <div class="flex flex-col sm:flex-row gap-3">
                <a target="_blank" rel="noopener"
                   href="https://forms.gle/5LTtnsVhSQprH3XU9"
                   class="inline-flex items-center justify-center gap-2 rounded-xl px-5 py-3 bg-indigo-600 text-white font-medium hover:bg-indigo-700">
                  กรอกแบบฟอร์มออนไลน์ 
                </a>
              </div>
              <p class="text-base">หน่วยวิจัยจะแจ้งลำดับการนำเสนอทางอีเมลภายในวันที่ 16 มกราคม 2569 หากไม่พบอีเมล ติดต่อ <a class="text-indigo-700 underline" href="mailto:rcst40.surgerycmu@gmail.com">rcst40.surgerycmu@gmail.com</a> หรือ <span class="font-medium">053-936132</span></p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- VENUE -->
    <section class="view" data-route="venue" aria-label="สถานที่จัดงาน">
      <div class="py-10">
        <div class="max-w-4xl mx-auto text-center">
          <div class="card rounded-3xl shadow-md p-8 md:py-10 md:px-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-4 text-gradient">สถานที่จัดงาน</h2>
            <p class="text-lg text-slate-700 mb-8">โรงแรมดิเอ็มเพรส เชียงใหม่</p>
            <a href="https://maps.app.goo.gl/G3ZDgYkQCbFV2wcC6?g_st=ipc" target="_blank" rel="noopener"
               class="inline-flex items-center justify-center w-full gap-2 rounded-2xl px-6 py-4 bg-indigo-600 text-white font-semibold shadow-lg hover:bg-indigo-700 transition">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18s6-5.686 6-10A6 6 0 104 8c0 4.314 6 10 6 10zm0-8a2 2 0 110-4 2 2 0 010 4z" clip-rule="evenodd"/></svg>
              เปิดดูแผนที่บน Google Maps
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- HOTELS -->
    <section class="view" data-route="hotels" aria-label="โรงแรม">
      <div class="py-10">
        <div class="max-w-5xl mx-auto">
          <h2 class="text-3xl sm:text-4xl font-bold text-gradient text-center mb-8">ที่พักแนะนำ</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="card rounded-3xl p-6 shadow-md">
              <h3 class="text-xl font-bold text-indigo-700 mb-2">แบบฟอร์มจอง The Empress</h3>
              <p class="text-slate-700 mb-4">กรอกแบบฟอร์มจองห้องพักสำหรับงานประชุม</p>
              <a target="_blank" rel="noopener"
                 <a
  href="https://raw.githubusercontent.com/chagkrit/rcst-2026-site/f6122e84849d242bff390085584b8b98bb9d16fc/RSVN%20Form%20Next%20%E2%80%93%20Gen%20Surgery%20Revolutionizing%20Surgical%20Practice%2012-13%20Feb%202026.doc.pdf"
  download="RSVN_Form_The_Empress.pdf"
  class="inline-flex items-center gap-2 rounded-xl px-5 py-3 bg-indigo-600 text-white font-medium hover:bg-indigo-700"
>
  ดาวน์โหลดแบบฟอร์ม
</a>
              </a>
            </div>
            <div class="card rounded-3xl p-6 shadow-md">
              <h3 class="text-xl font-bold text-indigo-700 mb-2">โรงแรมใกล้เคียง The Empress</h3>
              <p class="text-slate-700 mb-4">รายการโรงแรมบริเวณใกล้เคียง</p>
              <a target="_blank" rel="noopener"
                 href="https://www.canva.com/design/DAGzY7NLL3I/lh8TngAwhk6vD8hcBj9gFA/edit?utm_content=DAGzY7NLL3I&utm_campaign=designshare&utm_medium=link2&utm_source=sharebutton"
                 class="inline-flex items-center gap-2 rounded-xl px-5 py-3 bg-indigo-600 text-white font-medium hover:bg-indigo-700">
                ดูลิงก์โรงแรมใกล้เคียง
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section class="view" data-route="contact" aria-label="ติดต่อเรา">
      <div class="py-10">
        <div class="max-w-4xl mx-auto">
          <div class="card rounded-3xl shadow-md p-8 md:p-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient text-center">Contact Us</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
              <div class="flex justify-center">
                <img src="https://github.com/chagkrit/rcst-2026-site/blob/cc007ddc383e75ac1a1e60ee72c4a6db74228d57/LINE_RCST.png?raw=1" alt="QR LINE" class="w-64 h-auto rounded-xl shadow" loading="lazy">
              </div>
              <div class="text-center md:text-left">
                <p class="text-slate-700 mb-4">สแกน QR หรือติดต่ออีเมล</p>
                <a href="mailto:rcst40.surgerycmu@gmail.com" class="inline-flex items-center gap-2 px-4 py-3 rounded-xl bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M2.94 6.34A2 2 0 014.86 5h10.28a2 2 0 011.92 1.34l-7.06 4.12-7.06-4.12z"/><path d="M18 8.22l-6.74 3.93a2 2 0 01-2.52 0L2 8.22V14a2 2 0 002 2h12a2 2 0 002-2V8.22z"/></svg>
                  rcst40.surgerycmu@gmail.com
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="bg-white/50 backdrop-blur-xl text-slate-700 py-8 md:py-12 border-t border-white/40">
    <div class="container mx-auto px-4 text-center">
      <p class="text-2xl font-bold text-slate-800">MedCMU</p>
      <p class="text-sm text-slate-600">จัดโดยภาควิชาศัลยศาสตร์ คณะแพทยศาสตร์ มหาวิทยาลัยเชียงใหม่</p>
      <p class="text-xs text-slate-500 mt-2">© 2026 Surgery CMU. All rights reserved.</p>
    </div>
  </footer>

  <!-- ===== Scripts ===== -->

  <!-- Countdown -->
  <script>
    const EVENT_START_ISO='2026-02-12T08:00:00+07:00';
    const pad=n=>String(n).padStart(2,'0');
    const nodes={d:document.getElementById('cd-days'),h:document.getElementById('cd-hours'),m:document.getElementById('cd-mins'),s:document.getElementById('cd-secs'),note:document.getElementById('cd-note')};
    function tick(){
      if(!nodes.d) return;
      const now=Date.now(), target=new Date(EVENT_START_ISO).getTime();
      let diff=Math.max(0,target-now);
      const days=Math.floor(diff/86400000); diff-=days*86400000;
      const hours=Math.floor(diff/3600000); diff-=hours*3600000;
      const mins=Math.floor(diff/60000); diff-=mins*60000;
      const secs=Math.floor(diff/1000);
      nodes.d.textContent=pad(days); nodes.h.textContent=pad(hours); nodes.m.textContent=pad(mins); nodes.s.textContent=pad(secs);
      nodes.note.textContent=(target-now<=0)?'กำลังเริ่มงานวันนี้':'เริ่มงานในอีก';
    }
    tick(); setInterval(tick,1000);
  </script>

  <!-- SPA Router + Mobile -->
  <script>
    (function(){
      const header=document.getElementById('site-header'), stage=document.getElementById('stage');
      const views=[...document.querySelectorAll('.view')], routes=views.map(v=>v.dataset.route);
      const menuBtn=document.getElementById('menu-btn'), menu=document.getElementById('mobile-menu');

      const setHeaderHeight=()=>{ const h=header?.clientHeight||80; document.documentElement.style.setProperty('--header-h',h+'px'); };
      setHeaderHeight(); addEventListener('resize', setHeaderHeight);

      const resizeStageTo=(el)=>{ if(!el) return; const h=Math.max(el.scrollHeight, innerHeight-header.clientHeight); stage.style.height=h+'px'; };
      const getActive=()=>document.querySelector('.view.active');

      let isAnimating=false;
      const flipTo=(route,push=true)=>{
        if(isAnimating) return;
        if(!routes.includes(route)) route='home';
        const cur=getActive(), next=document.querySelector(`.view[data-route="${route}"]`);
        if(!next||cur===next){ resizeStageTo(next||cur); return; }
        isAnimating=true; next.classList.add('active','flip-in'); cur?.classList.add('flip-out');
        if(menu && !menu.classList.contains('hidden')) toggleMenu(false);
        resizeStageTo(next);
        const done=()=>{ cur?.classList.remove('active','flip-out'); next.classList.remove('flip-in'); isAnimating=false; };
        let t=setTimeout(done,800);
        next.addEventListener('transitionend', function te(e){ if(e.propertyName!=='transform') return; next.removeEventListener('transitionend', te); clearTimeout(t); done(); });
        if(push) location.hash='#'+route;
        dispatchEvent(new CustomEvent('view:changed',{detail:{route}}));
      };

      document.addEventListener('click', e=>{
        const a=e.target.closest('a[data-route]'); if(!a) return;
        e.preventDefault(); flipTo(a.getAttribute('data-route')||'home');
      });
      addEventListener('hashchange', ()=>{ const r=(location.hash||'#home').replace('#',''); flipTo(r,false); });
      flipTo((location.hash||'#home').replace('#',''), false);

      const toggleMenu=(open)=>{ const willOpen=(typeof open==='boolean')?open:menu.classList.contains('hidden'); menu.classList.toggle('hidden', !willOpen); menuBtn.setAttribute('aria-expanded', String(willOpen)); };
      menuBtn?.addEventListener('click', ()=>toggleMenu());
      menu?.querySelectorAll('a[data-route]').forEach(a=>a.addEventListener('click', ()=>toggleMenu(false)));
      document.addEventListener('keydown', e=>{ if(e.key==='Escape') toggleMenu(false); });

      resizeStageTo(getActive()); addEventListener('resize', ()=>resizeStageTo(getActive()));
      window.updateStageHeight=()=>resizeStageTo(getActive());
    })();
  </script>

  <!-- Gallery -->
  <script>
    (function(){
      const g=document.querySelector('.flip-gallery'); if(!g) return;
      const slides=[...g.querySelectorAll('.flip-slide')]; let i=0;
      function show(n){ const a=slides[i], b=slides[n]; if(a===b) return; a.classList.remove('active'); a.classList.add('out'); setTimeout(()=>a.classList.remove('out'),750); b.classList.add('active'); i=n; }
      setInterval(()=>show((i+1)%slides.length),2000);
    })();
  </script>

  <!-- Timeline (หัวข้อ) -->
  <script>
    (function(){
      const view=document.getElementById('view-speakers'); if(!view) return;

      /* ไม่มี Coffee/Lunch ใน DATA */
      const DATA=[
        // 12 Feb
        { day:'2026-02-12', cat:'General',  start:'08:00', end:'08:45', title:'Registration', subtitle:'ลงทะเบียน' },
        { day:'2026-02-12', cat:'General',  start:'08:45', end:'09:00', title:'Opening Ceremony', subtitle:'พิธีเปิด' },
        { day:'2026-02-12', cat:'General',  start:'09:00', end:'09:30', title:'Keynote Lecture', subtitle:'ปาฐกถา ศ.นพ.โอกาส พลางกูร' },
        { day:'2026-02-12', cat:'General',  start:'09:30', end:'09:40', title:'Award Ceremony', subtitle:'มอบรางวัลศิษย์เก่าศัลยแพทย์เชียงใหม่ดีเด่น' },
        { day:'2026-02-12', cat:'General',  start:'09:40', end:'10:00', title:'Distinguished Alumni Lecture', subtitle:'ปาฐกถาศิษย์เก่าดีเด่น' },

        { day:'2026-02-12', cat:'Upper GI', start:'10:30', end:'12:00', title:'Upper GI Surgery Session', subtitle:'Precision Surgery and Advanced MIS for Upper GI Surgery', detail:[
          '10:30–10:45 — POEM vs LHM — ผศ.นพ.ชัยณรงค์ พลานุสิตเทพา (Siriraj)',
          '10:45–11:00 — ESD for Early Gastric Cancer — รศ.ดร.พญ.สิริกาญจน์ ลิมปกาญจน์ (CMU)',
          '11:00–11:15 — LECS for Stomach GIST — ผศ.นพ.พันธุ์ภัทร์ จักรพันธุ์ (CMU)',
          '11:15–11:30 — Laparoscopic Gastrectomy — Prof. Tsuyoshi Etoh (Oita, JP)',
          '11:30–11:50 — Robotic Surgery & MIS Landscape — Prof. Koichi Suda (Fujita, JP)',
          '11:50–12:00 — Q&A',
        ]},

        { day:'2026-02-12', cat:'Colorectal', start:'13:00', end:'14:30', title:'Colorectal Surgery Session', subtitle:'Revolution of Rectal Cancer Treatment: Reframe, Refine and Resection', detail:[
          '13:00–13:15 — MRI of Rectal Cancer — อ.ดร.พญ.อมลยา อมันตกุล (CMU)',
          '13:15–13:30 — Rectal cancer RT updates — อ.พญ.ปิยภัสร์ ต่ออภิชาตตระกูล (CMU)',
          '13:30–13:45 — Systemic updates: TNT — ผศ.พญ.ธนิกา เกตุเผือก (CMU)',
          '13:45–14:00 — LPLND: When & How — อ.นพ.เอกรินทร์ ศุภตระกูล (CMU)',
          '14:00–14:15 — Minimally Invasive Rectal Surgery — ผศ.นพ.สุวรรณ แสนหมี่ (CMU)',
          '14:15–14:30 — Q&A',
        ]},

        { day:'2026-02-12', cat:'Surgical Critical Care', start:'15:00', end:'17:00', title:'Surgical Critical Care Session', subtitle:'ABCD for Critical Care Monitoring', detail:[
          '15:00–15:10 — Introduction to ABCD — ศ.นพ.กวีศักดิ์ จิตตวัฒนรัตน์ (CMU)',
          '15:10–15:30 — A: Airway & Breathing — พญ.ศรีสุลักษณ์ คะชา (CMU)',
          '15:30–15:50 — A: Abdomen & Metabolic — พญ.สุอาภา ธีระกุล (KKU)',
          '15:50–16:10 — B: Bleeding & Transfusion — รศ.ดร.พญ.โอสรี อัครบวร (PSU)',
          '16:10–16:30 — C: Circulation & Hemodynamics — นพ.อติรุจ ศุภพิพัฒน์ (CMU)',
          '16:30–16:50 — D: Delirium & Pain — พญ.ณัฐสุดา โพธิกุล (CMU)',
          '16:50–17:00 — Q&A',
        ]},

        // 13 Feb
        { day:'2026-02-13', cat:'Breast & Endocrine', start:'08:30', end:'10:00', title:'Breast & Endocrine Surgery Session', subtitle:'Precision Beyond Breast and Endocrine Surgery', detail:[
          '08:30–09:00 — Minimally Invasive Breast & Robotics — พญ.กรวรรณ จันทรจำนง',
          '09:00–09:30 — ICG for SLN mapping in breast cancer — ผศ.พญ.ปัญจพร วงศ์มณีรุ่ง (CMU)',
          '09:30–10:00 — Update in Thyroid Cancer Management — ผศ.นพ.กีรติ วัชราชันย์ (CMU)',
        ]},

        { day:'2026-02-13', cat:'Vascular', start:'10:30', end:'12:00', title:'Vascular Surgery Session', subtitle:'Challenges & Solution in Chronic Leg Ulcers', detail:[
          'Arterial Ulcer & Update PAD Guideline 2024 — ผศ.นพ.ศุภพงษ์ อาวรณ์',
          'Venous Ulcer & Result of Endovenous Treatment — ศ.นพ.กิตติพันธุ์ ฤกษ์เกษม',
          'Neuropathic Ulcer — ผศ.นพ.จิราวัฒน์ แสงสิน',
          'Wound Dressing & How to Choose — ผศ.นพ.เติมพงษ์ เรียนแพง',
        ]},

        { day:'2026-02-13', cat:'Trauma', start:'13:00', end:'14:30', title:'Trauma Surgery Session', subtitle:'Trauma in the Next Generation', detail:[
          'Evidence-based management in pancreatic injury — ผศ.พญ.ธิดารัตน์ จิรพงศ์เจริญลาภ',
          'Initial Trauma Resuscitation: Low Titer Group O Whole Blood — อ.นพ.ชลกานต์ วโรภาษ',
          'Evolving Trauma Training: ATLS® 11th Edition Update — อ.พญ.โอบเอื้อ หอมจันทร์',
          'Future of REBOA — ผศ.นพ.กำธน จันทร์แจ่ม',
        ]},

        { day:'2026-02-13', cat:'HBP', start:'15:00', end:'16:30', title:'Hepatopancreatobiliary Surgery Session', subtitle:'Mastery Technique of HBP Surgery in Emergency Setting', detail:[
          'Subtotal Cholecystectomy — อ.นพ.อานุสรณ์ กองก่อ',
          'Acute Pancreatitis: PCD → Necrosectomy — อ.พญ.รุ่งอรุณ นภาอำไพพร',
          'Bleeding in Operative Fields — อ.นพ.บรรณ วิทยชำนาญกุล',
          'Case Discussion — รศ.นพ.สัณหวิชญ์ จันทร์รังสี',
        ]},

        // 14 Feb
        { day:'2026-02-14', cat:'Workshop', start:'08:00', end:'16:00', title:'Minimal Invasive Hernia Workshop', subtitle:'CMU Cadaveric Center, อาคาร 50 ปี คณะแพทยศาสตร์ มช.' },
      ];

      const CAT_ALIASES={
        uppergi:['upper gi','ugi','upper gastrointestinal'],
        colorectal:['colorectal'],
        criticalcare:['critical care','surgical critical care','icu'],
        breast_endocrine:['breast & endocrine','breast and endocrine','b&e','be'],
        vascular:['vascular'],
        trauma:['trauma'],
        hbp:['hbp','hpb','hepatopancreatobiliary'],
        workshop:['workshop','hernia'],
        general:['general','plenary','ceremony','opening','award','keynote','alumni lecture']
      };
      const labelMap={general:'General / Plenary',uppergi:'Upper GI',colorectal:'Colorectal',criticalcare:'Critical Care',breast_endocrine:'Breast & Endocrine',vascular:'Vascular',trauma:'Trauma',hbp:'HBP',workshop:'Workshop'};
      const toSlug=raw=>{
        if(!raw) return '';
        const clean=String(raw).toLowerCase().normalize('NFKD').replace(/&/g,' and ').replace(/[^a-z0-9]+/g,' ').trim();
        for(const [slug,arr] of Object.entries(CAT_ALIASES)){ for(const a of arr){ const re=new RegExp('\\b'+a.replace(/\s+/g,'\\s*')+'\\b','i'); if(re.test(clean)) return slug; } }
        if(/\bupper\b\s*gi\b/.test(clean)) return 'uppergi';
        if(/\bcritical\b\s*care\b/.test(clean)) return 'criticalcare';
        return clean.replace(/\s+/g,'_');
      };
      const NDATA=DATA.map(d=>({...d,catSlug:toSlug(d.cat)}));

      const DAY_START='07:30', DAY_END='18:30', PX_MIN=1, PX_MAX=6, PX_DEFAULT=2;
      const rail=view.querySelector('.tl-viewport'), canvas=view.querySelector('#tl-canvas'), grid=view.querySelector('#tl-grid');
      const dayBtns=view.querySelectorAll('[data-day-btn]'), chips=view.querySelectorAll('[data-filter]');
      const btnL=view.querySelector('#tl-left'), btnR=view.querySelector('#tl-right'), btnNow=view.querySelector('#tl-now');
      const zOut=view.querySelector('#zoom-out'), zIn=view.querySelector('#zoom-in'), z1x=view.querySelector('#zoom-1x'), zLabel=view.querySelector('#zoom-label');

      let currentDay='2026-02-12', PX_PER_MIN=PX_DEFAULT, expandedGeneral=null;
      const activeCats=new Set(['all']);

      const toMin=hhmm=>{ const [h,m]=hhmm.split(':').map(Number); return h*60+m; };
      const clamp=(n,min,max)=>Math.min(max,Math.max(min,n));
      const dayStartMin=toMin(DAY_START), dayEndMin=toMin(DAY_END), MIN_PER_DAY=dayEndMin-dayStartMin;

      function updateZoomLabel(){ const s=(PX_PER_MIN/PX_DEFAULT).toFixed(2).replace(/\.00$/,''); zLabel.textContent=`สเกล ${s}× • ${PX_PER_MIN} px/นาที`; }
      function preserveScrollDuring(fn){ const w=canvas.getBoundingClientRect().width; const center=rail.scrollLeft+rail.clientWidth/2; const rel=w?center/w:0; fn(); const nw=canvas.getBoundingClientRect().width; rail.scrollLeft=Math.max(0, rel*nw - rail.clientWidth/2); }

      function drawGrid(){
        const width=MIN_PER_DAY*PX_PER_MIN; canvas.style.width=width+'px'; grid.innerHTML='';
        const startLabel=document.createElement('div'); startLabel.className='tl-hour-label'; startLabel.style.left='0px'; startLabel.textContent=DAY_START; grid.appendChild(startLabel);
        let t=Math.ceil(dayStartMin/60)*60; if(t===dayStartMin) t+=60;
        for(; t<=dayEndMin; t+=60){
          const x=(t-dayStartMin)*PX_PER_MIN;
          grid.appendChild(Object.assign(document.createElement('div'), {className:'tl-hour', style:`left:${x}px`} ));
          grid.appendChild(Object.assign(document.createElement('div'), {className:'tl-hour-label', style:`left:${x}px`, textContent:`${String(Math.floor(t/60)).padStart(2,'0')}:00`} ));
          const half=t+30; if(half<dayEndMin){ const hx=(half-dayStartMin)*PX_PER_MIN; grid.appendChild(Object.assign(document.createElement('div'), {className:'tl-half', style:`left:${hx}px`} )); }
        }
      }

      const ROW_HEIGHT=140;
      function layoutRows(cards){
        const layers=[];
        cards.forEach(card=>{
          const startX=parseFloat(card.style.left), endX=startX+parseFloat(card.style.width);
          let row=0; while(true){ if(!layers[row]||layers[row]<=startX){ layers[row]=endX+12; break; } row++; }
          card.style.top=(row*ROW_HEIGHT+30)+'px';
        });
        canvas.style.height=((layers.length||1)*ROW_HEIGHT+60)+'px';
        window.updateStageHeight && window.updateStageHeight();
      }

      const labelOf=slug=>labelMap[slug]||slug;
      function attachGeneralExpandHandlers(nodes){
        nodes.filter(n=>n.dataset.cat==='general').forEach(el=>{
          el.addEventListener('click', ()=>{
            if(expandedGeneral && expandedGeneral!==el) expandedGeneral.removeAttribute('data-expanded');
            const on=el.getAttribute('data-expanded')==='true';
            el.setAttribute('data-expanded', String(!on));
            expandedGeneral = !on ? el : null;
          });
          el.title='คลิกเพื่อขยาย/ย่อ';
        });
      }

      function renderDay(day){
        currentDay=day; expandedGeneral=null;
        dayBtns.forEach(b=>b.setAttribute('data-active', String(b.dataset.day===day)));
        canvas.querySelectorAll('.session').forEach(n=>n.remove());

        const showAll=activeCats.has('all')||activeCats.size===0;
        const list=NDATA.filter(d=> d.day===day && (showAll || activeCats.has(d.catSlug)));

        const created=[];
        list.forEach(d=>{
          const s=clamp(toMin(d.start), dayStartMin, dayEndMin);
          const e=clamp(toMin(d.end),   dayStartMin, dayEndMin);
          const w=Math.max(60,(e-s)*PX_PER_MIN);
          const x=(s-dayStartMin)*PX_PER_MIN;

          const el=document.createElement('article');
          el.className=`session cat-${d.catSlug}`;
          el.style.left=x+'px'; el.style.width=w+'px';
          el.setAttribute('data-cat', d.catSlug);
          el.setAttribute('aria-label', `${d.title} (${d.start}-${d.end})`);
          el.innerHTML=`
            <div class="text-xs text-slate-500">${d.start}–${d.end} • <span class="badge">${labelOf(d.catSlug)}</span></div>
            <h3 class="text-sm md:text-base font-extrabold mt-1">${d.title}</h3>
            <p class="text-xs md:text-sm text-slate-700">${d.subtitle||''}</p>
            ${d.detail?.length ? `<ul class="mt-2 text-xs md:text-sm text-slate-800 space-y-1">${d.detail.map(li=>`<li>• ${li}</li>`).join('')}</ul>`:''}
          `;
          canvas.appendChild(el);
          created.push(el);
        });

        drawGrid(); layoutRows(created); attachGeneralExpandHandlers(created);
      }

      function setAll(active){ activeCats.clear(); if(active) activeCats.add('all'); chips.forEach(c=>c.setAttribute('data-active', String(active && c.dataset.filter==='all'))); }
      function toggleCat(cat){
        if(cat==='all'){ setAll(true); renderDay(currentDay); return; }
        activeCats.delete('all');
        activeCats.has(cat) ? activeCats.delete(cat) : activeCats.add(cat);
        if(activeCats.size===0) setAll(true);
        chips.forEach(c=>{ const f=c.dataset.filter; c.setAttribute('data-active', String(activeCats.has('all') ? f==='all' : activeCats.has(f))); });
        renderDay(currentDay);
      }
      chips.forEach(chip=> chip.addEventListener('click', ()=> toggleCat(chip.dataset.filter)));

      dayBtns.forEach(btn=> btn.addEventListener('click', ()=> renderDay(btn.dataset.day)));
      btnL.addEventListener('click', ()=> rail.scrollBy({left:-400,behavior:'smooth'}));
      btnR.addEventListener('click', ()=> rail.scrollBy({left: 400,behavior:'smooth'}));
      btnNow.addEventListener('click', ()=> rail.scrollTo({left:0,behavior:'smooth'}));

      function setZoom(px){ PX_PER_MIN=Math.min(PX_MAX,Math.max(PX_MIN,px)); updateZoomLabel(); preserveScrollDuring(()=> renderDay(currentDay)); }
      zOut.addEventListener('click', ()=> setZoom(PX_PER_MIN-0.5));
      zIn .addEventListener('click', ()=> setZoom(PX_PER_MIN+0.5));
      z1x .addEventListener('click', ()=> setZoom(PX_DEFAULT));
      updateZoomLabel();

      addEventListener('view:changed', e=>{ if(e.detail?.route==='speakers'){ setTimeout(()=>{ preserveScrollDuring(()=> renderDay(currentDay)); },50); } });

      renderDay(currentDay);
      rail.addEventListener('scroll', ()=>{ window.updateStageHeight && window.updateStageHeight(); });
      addEventListener('resize', ()=>{ window.updateStageHeight && window.updateStageHeight(); });
    })();
  </script>
</body>
</html>