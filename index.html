<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Next-Gen Surgery: RCST 2026</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --glass-bg: rgba(255,255,255,0.70);
      --glass-brd: rgba(255,255,255,0.45);
      --header-h: 80px; /* อัปเดตด้วย JS ตามความสูงจริง */
    }
    body{
      font-family:'Inter',sans-serif;
      /* โทนม่วงอ่อนแบบมินิมอล (iOS glass) */
      background:
        radial-gradient(1200px 600px at -10% -10%, rgba(168,85,247,.10), transparent 55%),
        radial-gradient(900px 450px at 110% 0%, rgba(124,58,237,.08), transparent 55%),
        linear-gradient(180deg, #faf7ff 0%, #f5f0ff 45%, #efe9ff 100%);
      color:#0f172a;
    }
    .text-gradient{
      background:linear-gradient(90deg,#7c3aed,#2563eb);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .card{
      background:var(--glass-bg);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border:1px solid var(--glass-brd);
    }

    /* ===== Flip SPA Stage ===== */
    #stage {
      position: relative;
      perspective: 1200px;
      margin-top: var(--header-h);
      min-height: calc(100vh - var(--header-h));
      transition: height .35s ease;
    }
    .view{
      position: absolute; inset: 0;
      padding: 16px 0;
      opacity: 0; pointer-events: none;
      transform: rotateY(90deg) scale(.98);
      transform-origin: 50% 50%;
      backface-visibility: hidden;
      will-change: transform, opacity;
      transition: transform .7s cubic-bezier(.2,.65,.2,1), opacity .35s ease;
    }
    .view.active{ opacity: 1; pointer-events: auto; transform: rotateY(0deg) scale(1); }
    .view.flip-out{ opacity: 0; transform: rotateY(-90deg) scale(.98); }
    .view.flip-in{ opacity: 1; transform: rotateY(0deg) scale(1); }

    .hero-title { margin-bottom: 1rem; }
    .hero-sub   { margin-top: 1rem; margin-bottom: 2rem; }

    /* Countdown tiles */
    .cd-tile{
      min-width: 76px; padding: 12px 10px; border-radius: 16px; text-align:center;
      background: var(--glass-bg); border:1px solid var(--glass-brd);
      backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 8px 24px rgba(15, 23, 42, .06);
    }
    .cd-value{ font-size: 1.5rem; font-weight: 800; line-height: 1; color:#0f172a;}
    .cd-label{ font-size: .75rem; color:#475569; margin-top:.25rem; letter-spacing:.02em;}

    /* Mobile menu panel offset */
    #mobile-menu{ top: var(--header-h); }

    /* ===== Speakers timeline (สีหมวด) ===== */
    .chip{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.5rem .75rem; border-radius:9999px; font-size:.875rem;
      border:1px solid rgba(255,255,255,0.5);
      background:rgba(255,255,255,.6); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
      transition: background .2s ease, color .2s ease, border-color .2s ease;
      cursor:pointer; user-select:none;
    }
    .chip[data-active="true"]{ background:#4f46e5; color:#fff; border-color:#4f46e5; }

    .tl-viewport{ position:relative; overflow-x:auto; overflow-y:visible; }
    .tl-canvas{ position:relative; height:auto; min-height: 260px; margin-top:.5rem; }
    .tl-grid{ position:absolute; left:0; right:0; top:0; height:0; }
    .tl-hour{ position:absolute; top:0; bottom:0; width:1px; background:rgba(15,23,42,.08); }
    .tl-half{ position:absolute; top:0; bottom:0; width:1px; background:rgba(15,23,42,.05); }
    .tl-hour-label{
      position:absolute; top:-1.75rem; transform:translateX(-50%);
      font-size:.75rem; color:#64748b; white-space:nowrap;
      background:rgba(255,255,255,.7); padding:.1rem .35rem; border-radius:.5rem; border:1px solid rgba(255,255,255,.6);
    }

    .session{
      position:absolute; min-width:160px; border-radius:16px; padding:12px 14px;
      border:1px solid var(--glass-brd); background:var(--glass-bg);
      box-shadow: 0 10px 24px rgba(2,6,23,.06); transition: transform .2s ease, box-shadow .2s ease;
    }
    .session:hover{ transform: translateY(-2px); box-shadow: 0 14px 30px rgba(2,6,23,.10); }

    .badge{ display:inline-block; font-size:.675rem; padding:.2rem .5rem; border-radius:9999px; border:1px solid currentColor; opacity:.85; }

    .cat-uppergi          { --cat:#dc2626; }
    .cat-colorectal       { --cat:#16a34a; }
    .cat-criticalcare     { --cat:#0891b2; }
    .cat-breast_endocrine { --cat:#9333ea; }
    .cat-vascular         { --cat:#2563eb; }
    .cat-trauma           { --cat:#ea580c; }
    .cat-hbp              { --cat:#065f46; }
    .cat-general          { --cat:#334155; }
    .session h3{ color: var(--cat); }
    .session .badge{ color: var(--cat); background: color-mix(in oklab, var(--cat) 12%, white); border-color: color-mix(in oklab, var(--cat) 55%, white); }
    .session{ border-color: color-mix(in oklab, var(--cat) 45%, white); }

    .session[data-cat="general"]{ cursor: zoom-in; }
    .session[data-cat="general"][data-expanded="true"]{
      transform: scale(1.07);
      z-index: 30; box-shadow: 0 24px 50px rgba(2,6,23,.18); border-width: 2px;
    }

    /* ===== Flip gallery (แทนวิดีโอ) ===== */
    .flip-gallery{ position:relative; perspective:1200px; }
    .flip-slide{
      position:absolute; inset:0; opacity:0;
      transform: rotateY(90deg) scale(.98);
      transform-origin: 50% 50%;
      transition: transform .7s cubic-bezier(.2,.65,.2,1), opacity .35s ease;
      backface-visibility: hidden;
      object-fit:cover;
    }
    .flip-slide.active{ opacity:1; transform: rotateY(0deg) scale(1); z-index:2; }
    .flip-slide.out{ opacity:0; transform: rotateY(-90deg) scale(.98); z-index:1; }
  </style>
</head>
<body>

  <!-- Header -->
  <header id="site-header" class="bg-white/60 backdrop-blur-xl fixed top-0 left-0 right-0 z-50 border-b border-white/30">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
      <!-- โลโก้ RCST + รูปต่อท้าย -->
      <a href="#home" data-route="home" class="flex items-center gap-3">
        <div class="text-xl font-bold text-gradient">RCST 2026</div>
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/e962eddce38d5880ae976db69232a4f8f7b8acb9/RCST.png?raw=1" alt="ตราราชวิทยาลัยศัลยแพทย์แห่งประเทศไทย" class="h-8 w-auto">
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/e962eddce38d5880ae976db69232a4f8f7b8acb9/surgery.png?raw=1" alt="คณะแพทยศาสตร์ มช. & Surgery CMU" class="h-8 w-auto">
        <img src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/logo.jpg?raw=1" alt="พันธมิตรงาน RCST" class="h-8 w-auto">
      </a>

      <!-- Desktop nav -->
      <div class="hidden md:flex space-x-8 text-sm font-medium">
        <a href="#about"    data-route="about"    class="text-slate-700 hover:text-indigo-600 transition-colors">เกี่ยวกับ</a>
        <a href="#dates"    data-route="dates"    class="text-slate-700 hover:text-indigo-600 transition-colors">กำหนดการ</a>
        <a href="#speakers" data-route="speakers" class="text-slate-700 hover:text-indigo-600 transition-colors">หัวข้อ</a>
        <a href="#venue"    data-route="venue"    class="text-slate-700 hover:text-indigo-600 transition-colors">สถานที่</a>
        <a href="#contact"  data-route="contact"  class="text-slate-700 hover:text-indigo-600 transition-colors">ติดต่อ</a>
      </div>

      <!-- Mobile menu button -->
      <button id="menu-btn" class="md:hidden p-2 rounded-lg bg-white/70 hover:bg-white" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
    </nav>

    <!-- Mobile menu panel -->
    <div id="mobile-menu" class="md:hidden hidden fixed inset-x-0 z-40 px-4">
      <div class="mx-auto max-w-2xl rounded-2xl bg-white/95 backdrop-blur-xl shadow-xl ring-1 ring-black/5 py-3">
        <a href="#about"    data-route="about"    class="block px-4 py-3 text-slate-700 hover:bg-slate-100 rounded-lg">เกี่ยวกับ</a>
        <a href="#dates"    data-route="dates"    class="block px-4 py-3 text-slate-700 hover:bg-slate-100 rounded-lg">กำหนดการ</a>
        <a href="#speakers" data-route="speakers" class="block px-4 py-3 text-slate-700 hover:bg-slate-100 rounded-lg">หัวข้อ</a>
        <a href="#venue"    data-route="venue"    class="block px-4 py-3 text-slate-700 hover:bg-slate-100 rounded-lg">สถานที่</a>
        <a href="#contact"  data-route="contact"  class="block px-4 py-3 text-slate-700 hover:bg-slate-100 rounded-lg">ติดต่อ</a>
      </div>
    </div>
  </header>

  <!-- ===== Stage (Flip SPA Container) ===== -->
  <main id="stage" class="container mx-auto px-4">

    <!-- ========== HOME ========== -->
    <section class="view active" data-route="home" aria-label="หน้าแรก">
      <!-- Hero -->
      <div class="min-h-[calc(100vh-140px)] flex flex-col justify-center items-center text-center">
        <h1 class="hero-title text-3xl sm:text-4xl md:text-5xl font-extrabold text-gradient">
          งานประชุมราชวิทยาลัยศัลยแพทย์แห่งประเทศไทยส่วนภูมิภาค ประจำปี 2569
        </h1>
        <p class="hero-sub text-2xl md:text-3xl font-bold text-slate-800 mt-4 md:mt-6">
          <span class="text-indigo-700">Next-Gen Surgery:</span><br/>Revolutionizing Surgical Practice
        </p>

        <!-- ปุ่มลงทะเบียน -->
        <a href="https://forms.fillout.com/t/izJe9c3BL5us"
           target="_blank" rel="noopener"
           class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-full shadow-lg transition-all duration-300 transform hover:scale-[1.02]">
          ลงทะเบียน
        </a>

        <!-- Countdown -->
        <div class="mt-6 flex items-center justify-center">
          <div class="flex gap-3" aria-live="polite">
            <div class="cd-tile"><div id="cd-days" class="cd-value">00</div><div class="cd-label">วัน</div></div>
            <div class="cd-tile"><div id="cd-hours" class="cd-value">00</div><div class="cd-label">ชั่วโมง</div></div>
            <div class="cd-tile"><div id="cd-mins" class="cd-value">00</div><div class="cd-label">นาที</div></div>
            <div class="cd-tile"><div id="cd-secs" class="cd-value">00</div><div class="cd-label">วินาที</div></div>
          </div>
        </div>
        <p id="cd-note" class="mt-2 text-sm text-slate-500"></p>
      </div>

      <!-- Gallery (แทนวิดีโอ) -->
      <section class="py-8 md:py-12">
        <div class="max-w-4xl mx-auto">
          <div class="card rounded-3xl shadow-md overflow-hidden">
            <div class="flip-gallery w-full h-[56vh] md:h-[68vh]">
              <img class="flip-slide active" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu1.JPG?raw=1" alt="MedCMU 1" loading="eager">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu2.JPG?raw=1" alt="MedCMU 2" loading="lazy">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu3.JPG?raw=1" alt="MedCMU 3" loading="lazy">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu4.jpg?raw=1" alt="MedCMU 4" loading="lazy">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu5.png?raw=1" alt="MedCMU 5" loading="lazy">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu6.JPG?raw=1" alt="MedCMU 6" loading="lazy">
              <img class="flip-slide" src="https://github.com/chagkrit/rcst-2026-site/blob/64bea96e01b4aec649ae858f68ee272be3d7c96e/Medcmu7.jpg?raw=1" alt="MedCMU 7" loading="lazy">
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- ========== ABOUT ========== -->
    <section class="view" data-route="about" aria-label="เกี่ยวกับงานประชุม">
      <div class="py-10">
        <div class="max-w-4xl mx-auto text-center">
          <div class="card rounded-3xl shadow-md p-8 md:p-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient">เกี่ยวกับงานประชุม</h2>
            <p class="text-lg text-slate-700 leading-relaxed">
              งานประชุมราชวิทยาลัยศัลยแพทย์แห่งประเทศไทยส่วนภูมิภาค Regional RCST 2026 in Chiang Mai เป็นงานประชุมวิชาการที่รวบรวมผู้เชี่ยวชาญด้านศัลยกรรมจากทั่วภูมิภาคและระดับนานาชาติ เพื่อแลกเปลี่ยนความรู้และนวัตกรรมล่าสุดในวงการแพทย์
            </p>
            <p class="text-lg text-slate-700 leading-relaxed mt-4">
              เตรียมพร้อมสำหรับอนาคตของการผ่าตัด ที่ก้าวล้ำด้วยเทคโนโลยีและเทคนิคใหม่ๆ ที่จะมาพลิกโฉมวงการศัลยกรรม
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== DATES (12–13 ก.พ.) ========== -->
    <section class="view" data-route="dates" aria-label="กำหนดการ">
      <div class="py-10">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl sm:text-4xl font-bold text-center mb-12 text-gradient">กำหนดการและหัวข้อการประชุม</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- 12 Feb -->
            <div class="card rounded-3xl p-6 shadow-md transition-all hover:shadow-xl">
              <h3 class="text-base font-semibold text-slate-500">วันที่</h3>
              <h4 class="text-xl font-bold text-indigo-700 mb-4">12 กุมภาพันธ์ 2569</h4>
              <ul class="list-none space-y-3 text-slate-700">
                <li><span class="font-medium">08:00–08:45 ลงทะเบียน</span></li>
                <li><span class="font-medium">08:45–09:00 พิธีเปิด</span></li>
                <li><span class="font-medium">09:00–09:30 ปาฐกถา ศ.นพ.โอกาส พลางกูร</span></li>
                <li><span class="font-medium">09:30–09:40 พิธีมอบรางวัลศิษย์เก่าศัลยแพทย์เชียงใหม่ดีเด่น</span></li>
                <li><span class="font-medium">09:40–10:00 ปาฐกถาศิษย์เก่าดีเด่น</span></li>
                <li><span class="font-medium">10:30–12:00 Upper GI Surgery • Precision Surgery and Advanced MIS for Upper GI Surgery</span></li>
                <li><span class="font-medium">12:00–13:00 Lunch Symposium</span></li>
                <li><span class="font-medium">13:00–14:30 Colorectal Surgery • Revolution of Rectal Cancer Treatment</span></li>
                <li><span class="font-medium">14:30–15:00 Coffee Break</span></li>
                <li><span class="font-medium">15:00–17:00 Surgical Critical Care • ABCD for Critical Care Monitoring</span></li>
              </ul>
            </div>
            <!-- 13 Feb -->
            <div class="card rounded-3xl p-6 shadow-md transition-all hover:shadow-xl">
              <h3 class="text-base font-semibold text-slate-500">วันที่</h3>
              <h4 class="text-xl font-bold text-indigo-700 mb-4">13 กุมภาพันธ์ 2569</h4>
              <ul class="list-none space-y-3 text-slate-700">
                <li><span class="font-medium">08:30–10:00 <b>Breast & Endocrine</b> Surgery • Precision Beyond Breast and Endocrine Surgery</span></li>
                <li><span class="font-medium">10:00–10:30 Coffee Break</span></li>
                <li><span class="font-medium">10:30–12:00 Vascular Surgery • Challenges & Solution in Chronic Leg Ulcers</span></li>
                <li><span class="font-medium">12:00–13:00 Lunch Symposium</span></li>
                <li><span class="font-medium">13:00–14:30 Trauma Surgery • Trauma in the Next Generation</span></li>
                <li><span class="font-medium">14:30–15:00 Coffee Break</span></li>
                <li><span class="font-medium">15:00–16:30 HBP Surgery • Mastery Technique of HBP Surgery in Emergency Setting</span></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== SPEAKERS / TOPICS (Real time-axis + filters + zoom) ========== -->
    <section class="view" data-route="speakers" aria-label="หัวข้อ" id="view-speakers">
      <!-- … (โค้ด timeline/filters/zoom เดิมของคุณ — ไม่เปลี่ยน) … -->
    </section>

    <!-- ========== VENUE ========== -->
    <section class="view" data-route="venue" aria-label="สถานที่จัดงาน">
      <div class="py-10">
        <div class="max-w-4xl mx-auto text-center">
          <div class="card rounded-3xl shadow-md p-8 md:py-10 md:px-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-4 text-gradient">สถานที่จัดงาน</h2>
            <p class="text-lg text-slate-700 leading-relaxed mb-8">โรงแรมดิเอ็มเพรส เชียงใหม่</p>
            <a href="https://maps.app.goo.gl/G3ZDgYkQCbFV2wcC6?g_st=ipc" target="_blank" rel="noopener"
               class="inline-flex items-center justify-center w-full gap-2 rounded-2xl px-6 py-4 bg-indigo-600 text-white font-semibold shadow-lg hover:bg-indigo-700 transition">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path fill-rule="evenodd" d="M10 18s6-5.686 6-10A6 6 0 104 8c0 4.314 6 10 6 10zm0-8a2 2 0 110-4 2 2 0 010 4z" clip-rule="evenodd"/>
              </svg>
              เปิดดูแผนที่บน Google Maps
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== CONTACT ========== -->
    <section class="view" data-route="contact" aria-label="ติดต่อเรา">
      <div class="py-10">
        <div class="max-w-4xl mx-auto">
          <div class="card rounded-3xl shadow-md p-8 md:p-10">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6 text-gradient text-center">Contact Us</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
              <!-- QR -->
              <div class="flex justify-center">
                <img src="https://github.com/chagkrit/rcst-2026-site/blob/cc007ddc383e75ac1a1e60ee72c4a6db74228d57/LINE_RCST.png?raw=1" alt="QR Code RCST LINE" class="w-64 h-auto rounded-xl shadow" loading="lazy">
              </div>
              <!-- Email -->
              <div class="text-center md:text-left">
                <p class="text-slate-700 mb-4">สแกน QR เพื่อติดต่อทีมงาน หรืออีเมลหาเราได้ที่</p>
                <a href="mailto:rcst40.surgerycmu@gmail.com"
                   class="inline-flex items-center gap-2 px-4 py-3 rounded-xl bg-indigo-600 text-white font-medium shadow hover:bg-indigo-700 transition">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path d="M2.94 6.34A2 2 0 014.86 5h10.28a2 2 0 011.92 1.34l-7.06 4.12-7.06-4.12z"/>
                    <path d="M18 8.22l-6.74 3.93a2 2 0 01-2.52 0L2 8.22V14a2 2 0 002 2h12a2 2 0 002-2V8.22z"/>
                  </svg>
                  rcst40.surgerycmu@gmail.com
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="bg-white/50 backdrop-blur-xl text-slate-700 py-8 md:py-12 border-t border-white/40">
    <div class="container mx-auto px-4 text-center">
      <div class="flex flex-col items-center mb-6">
        <p class="text-2xl font-bold text-slate-800">MedCMU</p>
      </div>
      <p class="text-sm text-slate-600">จัดโดยภาควิชาศัลยศาสตร์ คณะแพทยศาสตร์ มหาวิทยาลัยเชียงใหม่</p>
      <p class="text-xs text-slate-500 mt-2">© 2026 Surgery CMU. All rights reserved.</p>
    </div>
  </footer>

  <!-- ========= Scripts ========= -->

  <!-- Countdown Script -->
  <script>
    // เริ่มงานหลัก 12 ก.พ. 2569 เวลา 08:00 (ICT)
    const EVENT_START_ISO = '2026-02-12T08:00:00+07:00';
    const pad = (n) => String(n).padStart(2,'0');
    const nodes = {
      d: document.getElementById('cd-days'),
      h: document.getElementById('cd-hours'),
      m: document.getElementById('cd-mins'),
      s: document.getElementById('cd-secs'),
      note: document.getElementById('cd-note')
    };
    function tick() {
      if (!nodes.d) return;
      const now = new Date().getTime();
      const target = new Date(EVENT_START_ISO).getTime();
      let diff = Math.max(0, target - now);
      const days = Math.floor(diff / 86400000); diff -= days * 86400000;
      const hours = Math.floor(diff / 3600000); diff -= hours * 3600000;
      const mins = Math.floor(diff / 60000);    diff -= mins * 60000;
      const secs = Math.floor(diff / 1000);
      nodes.d.textContent = pad(days); nodes.h.textContent = pad(hours);
      nodes.m.textContent = pad(mins); nodes.s.textContent = pad(secs);
      nodes.note.textContent = (target - now <= 0) ? 'กำลังเริ่มงานวันนี้' : 'เริ่มงานในอีก';
    }
    tick(); setInterval(tick, 1000);
  </script>

  <!-- Flip SPA Router + Mobile Menu -->
  <script>
    (function(){
      const header   = document.getElementById('site-header');
      const stage    = document.getElementById('stage');
      const views    = Array.from(document.querySelectorAll('.view'));
      const routes   = views.map(v => v.dataset.route);
      const menuBtn  = document.getElementById('menu-btn');
      const menu     = document.getElementById('mobile-menu');

      const setHeaderHeight = () => {
        const h = header?.clientHeight || 80;
        document.documentElement.style.setProperty('--header-h', h + 'px');
      };
      setHeaderHeight(); window.addEventListener('resize', setHeaderHeight);

      const resizeStageTo = (el) => {
        if (!el) return;
        const h = Math.max(el.scrollHeight, window.innerHeight - header.clientHeight);
        stage.style.height = h + 'px';
      };

      const getActive = () => document.querySelector('.view.active');

      let isAnimating = false;
      const flipTo = (route, pushHash = true) => {
        if (isAnimating) return;
        if (!routes.includes(route)) route = 'home';

        const current = getActive();
        const next = document.querySelector(`.view[data-route="${route}"]`);
        if (!next || current === next) { resizeStageTo(next || current); return; }

        isAnimating = true;
        next.classList.add('active','flip-in');
        current?.classList.add('flip-out');

        if (menu && !menu.classList.contains('hidden')) toggleMenu(false);
        resizeStageTo(next);

        const done = () => { current?.classList.remove('active','flip-out'); next.classList.remove('flip-in'); isAnimating = false; };
        let t = setTimeout(done, 800);
        next.addEventListener('transitionend', function te(e){
          if (e.propertyName !== 'transform') return;
          next.removeEventListener('transitionend', te);
          clearTimeout(t); done();
        });

        if (pushHash) location.hash = '#' + route;
        window.dispatchEvent(new CustomEvent('view:changed', { detail: { route } }));
      };

      document.addEventListener('click', (e) => {
        const a = e.target.closest('a[data-route]');
        if (!a) return;
        e.preventDefault();
        flipTo(a.getAttribute('data-route') || 'home');
      });

      window.addEventListener('hashchange', () => {
        const r = (location.hash || '#home').replace('#','');
        flipTo(r, false);
      });

      flipTo((location.hash || '#home').replace('#',''), false);

      const toggleMenu = (open) => {
        const willOpen = (typeof open === 'boolean') ? open : menu.classList.contains('hidden');
        menu.classList.toggle('hidden', !willOpen);
        menuBtn.setAttribute('aria-expanded', String(willOpen));
      };
      menuBtn?.addEventListener('click', () => toggleMenu());
      menu?.querySelectorAll('a[data-route]').forEach(a => a.addEventListener('click', () => toggleMenu(false)));
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') toggleMenu(false); });

      resizeStageTo(getActive());
      window.addEventListener('resize', () => resizeStageTo(getActive()));
      window.updateStageHeight = () => resizeStageTo(getActive());
    })();
  </script>

  <!-- Flip gallery logic (แสดงแต่ละรูป 2 วินาที วนลูป พร้อมเอฟเฟกต์ flip) -->
  <script>
    (function(){
      const gallery = document.querySelector('.flip-gallery'); if(!gallery) return;
      const slides  = Array.from(gallery.querySelectorAll('.flip-slide'));
      let idx = 0;
      function show(next){
        const curEl = slides[idx];
        const nextEl = slides[next];
        if(curEl === nextEl) return;
        // flip out ปัจจุบัน
        curEl.classList.remove('active');
        curEl.classList.add('out');
        setTimeout(()=>curEl.classList.remove('out'), 750); // ตรงกับ transition
        // flip in รูปถัดไป
        nextEl.classList.add('active');
        idx = next;
      }
      setInterval(()=>{
        const n = (idx + 1) % slides.length;
        show(n);
      }, 2000); // ทุก 2 วินาที
    })();
  </script>

  <!-- Timeline + Filters ของคุณ (เวอร์ชันเดิมที่ใช้อยู่) -->
  <script>
    /* … โค้ด timeline/filters/zoom ฉบับเต็มของคุณวางต่อจากนี้ … */
  </script>
</body>
</html>